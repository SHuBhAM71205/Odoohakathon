import type { Document } from '../bson';
import type { Db } from '../db';
import { type Abortable } from '../mongo_types';
import { executeOperation } from '../operations/execute_operation';
import {
  type CollectionInfo,
  ListCollectionsOperation,
  type ListCollectionsOptions
} from '../operations/list_collections';
import type { ClientSession } from '../sessions';
import { AbstractCursor, type InitialCursorResponse } from './abstract_cursor';

  async _initialize(session: ClientSession | undefined): Promise<InitialCursorResponse> {
    const operation = new ListCollectionsOperation(this.parent, this.filter, {
      ...this.cursorOptions,
      ...this.options,
      session,
      signal: this.signal
    });

    const response = await executeOperation(this.parent.client, operation, this.timeoutContext);

    return { server: operation.server, session, response };
  }
}
